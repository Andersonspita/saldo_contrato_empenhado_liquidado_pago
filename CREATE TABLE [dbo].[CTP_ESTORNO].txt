CREATE TABLE [dbo].[CTP_ESTORNO](
	[EST_COD] [int] IDENTITY(1,1) NOT NULL,
	[EST_DATA] [smalldatetime] NOT NULL,
	[EST_TIPO] [char](1) NOT NULL,
	[EST_MOTIVO] [varchar](500) NOT NULL,
	[EST_NUMERO] [int] NOT NULL,
	[EST_VALOR] [decimal](18, 2) NOT NULL,
	[EMP_COD] [int] NOT NULL,
	[LIQ_COD] [int] NULL,
	[PAG_COD] [int] NULL,
	[EST_FECHADO] [char](1) NOT NULL,
	[EST_MES] [smallint] NOT NULL,
	[EST_ANO] [smallint] NOT NULL,
	[EST_AUTOMATICO] [char](1) NULL,
	[CON_COD] [int] NULL,
	[ORG_COD] [int] NULL,
	[DEV_COD] [int] NULL,
	[EST_DEVOLUCAO] [char](1) NULL,
 CONSTRAINT [PK_CTP_ESTORNO] PRIMARY KEY CLUSTERED 
(
	[EST_COD] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY],
 CONSTRAINT [IX_CTP_ESTORNO] UNIQUE NONCLUSTERED 
(
	[EST_NUMERO] ASC,
	[EST_TIPO] ASC,
	[EST_ANO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO

ALTER TABLE [dbo].[CTP_ESTORNO] ADD  CONSTRAINT [DF_CTP_ESTORNO_EST_FECHADO]  DEFAULT ('N') FOR [EST_FECHADO]
GO

ALTER TABLE [dbo].[CTP_ESTORNO]  WITH NOCHECK ADD  CONSTRAINT [FK_CTP_ESTORNO_CTP_EMPENHO] FOREIGN KEY([EMP_COD])
REFERENCES [dbo].[CTP_EMPENHO] ([EMP_COD])
ON DELETE CASCADE
GO

ALTER TABLE [dbo].[CTP_ESTORNO] CHECK CONSTRAINT [FK_CTP_ESTORNO_CTP_EMPENHO]
GO

ALTER TABLE [dbo].[CTP_ESTORNO]  WITH NOCHECK ADD  CONSTRAINT [FK_CTP_ESTORNO_CTP_LIQUIDACAO] FOREIGN KEY([LIQ_COD])
REFERENCES [dbo].[CTP_LIQUIDACAO] ([LIQ_COD])
GO

ALTER TABLE [dbo].[CTP_ESTORNO] CHECK CONSTRAINT [FK_CTP_ESTORNO_CTP_LIQUIDACAO]
GO

ALTER TABLE [dbo].[CTP_ESTORNO]  WITH NOCHECK ADD  CONSTRAINT [FK_CTP_ESTORNO_CTP_PAGAMENTO] FOREIGN KEY([PAG_COD])
REFERENCES [dbo].[CTP_PAGAMENTO] ([PAG_COD])
GO

ALTER TABLE [dbo].[CTP_ESTORNO] CHECK CONSTRAINT [FK_CTP_ESTORNO_CTP_PAGAMENTO]
GO

ALTER TABLE [dbo].[CTP_ESTORNO]  WITH NOCHECK ADD  CONSTRAINT [FK_CTP_ESTORNO_GER_ANO] FOREIGN KEY([EST_ANO])
REFERENCES [dbo].[GER_ANO] ([ANO_COD])
GO

ALTER TABLE [dbo].[CTP_ESTORNO] CHECK CONSTRAINT [FK_CTP_ESTORNO_GER_ANO]
GO

ALTER TABLE [dbo].[CTP_ESTORNO]  WITH NOCHECK ADD  CONSTRAINT [FK_CTP_ESTORNO_GER_MES] FOREIGN KEY([EST_MES])
REFERENCES [dbo].[GER_MES] ([MES_COD])
GO

ALTER TABLE [dbo].[CTP_ESTORNO] CHECK CONSTRAINT [FK_CTP_ESTORNO_GER_MES]
GO

ALTER TABLE [dbo].[CTP_ESTORNO]  WITH CHECK ADD  CONSTRAINT [FK_CTP_ESTORNO_GER_ORGAO] FOREIGN KEY([ORG_COD])
REFERENCES [dbo].[GER_ORGAO] ([ORG_COD])
GO

ALTER TABLE [dbo].[CTP_ESTORNO] CHECK CONSTRAINT [FK_CTP_ESTORNO_GER_ORGAO]
GO

ALTER TABLE [dbo].[CTP_ESTORNO]  WITH CHECK ADD  CONSTRAINT [FK_CTP_ESTORNO_REF_CTP_CONF_PLANO_DE_CONTAS_CON_COD] FOREIGN KEY([CON_COD])
REFERENCES [dbo].[CTP_CONF_PLANO_DE_CONTAS] ([CON_COD])
GO

ALTER TABLE [dbo].[CTP_ESTORNO] CHECK CONSTRAINT [FK_CTP_ESTORNO_REF_CTP_CONF_PLANO_DE_CONTAS_CON_COD]
GO

ALTER TABLE [dbo].[CTP_ESTORNO]  WITH CHECK ADD  CONSTRAINT [FK_DEV_COD_CTP_ESTORNO] FOREIGN KEY([DEV_COD])
REFERENCES [dbo].[CTP_DEVOLUCAO] ([DEV_COD])
GO

ALTER TABLE [dbo].[CTP_ESTORNO] CHECK CONSTRAINT [FK_DEV_COD_CTP_ESTORNO]
GO

